apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "wp-scale.fullname" . }}-htaccess
  labels:
    app.kubernetes.io/name: {{ include "wp-scale.name" . }}
    app.kubernetes.io/instance: {{ .Release.Name }}
data:
  htaccess: |-
    # BEGIN Utilize S3 bucket rather than localhost for "uploads" folder - Via https://tinyurl.com/s3redirect
    RewriteRule ^wp-content/uploads/(.*)$ https://hel1.your-objectstorage.com/iranbroker/$1 [R,L]
    # END Utilize S3 bucket
    # BEGIN WordPress

    RewriteEngine On
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
    RewriteBase /
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]

    # END WordPress